# NETWORK EXPLOITATION

## Metasploitable 2

### Demonstration of 2 exploits performed
**1. exploit(multi/http/php_cgi_arg_injection)**
```ruby
search exploit
show exploit(multi/http/php_cgi_arg_injection)
set RHOST 192.168.1.22
run
```

**2.exploit(unix/ftp/vsftpd 234 backdoor)**
```ruby
search exploit
show exploit(unix/ftp/vsftpd 234 backdoor)
set RHOST 192.168.1.22
run
```

### Vulnerabilities discovered
**1. exploit(multi/http/php_cgi_arg_injection)**      
- The **`multi/http/php_cgi_arg_injection`** exploit in Metasploit targets a vulnerability in PHP-CGI that allows an attacker to execute arbitrary code on the target system.
- PHP-CGI is a Common Gateway Interface (CGI) interface that allows web servers to execute PHP scripts. The vulnerability exists in the way PHP-CGI handles query strings passed in the **`QUERY_STRING`** environment variable. By injecting specially crafted query strings, an attacker can cause PHP-CGI to execute arbitrary code.
- The **`multi/http/php_cgi_arg_injection`** exploit module in Metasploit sends a crafted request to the target system's PHP-CGI server, which triggers the vulnerability and allows the attacker to execute arbitrary code. The exploit can be used to gain a remote shell on the target system with the privileges of the user running the PHP-CGI server.
        
2. **exploit(unix/ftp/vsftpd 234 backdoor)**
- The **`unix/ftp/vsftpd 234 backdoor`** exploit targets a backdoor that was present in the vsftpd FTP server version 2.3.4. The backdoor was intentionally inserted by the original author of vsftpd, and was discovered in 2011 by a security researcher.
- The backdoor allows an attacker to authenticate to the vsftpd server using a hard-coded username and password combination, which grants the attacker access to a remote shell with root privileges on the target system. This vulnerability could be exploited remotely, without requiring any credentials or authentication.
- The **`unix/ftp/vsftpd 234 backdoor`** exploit module in Metasploit attempts to exploit this vulnerability by sending a specially crafted string of characters to the target system's vsftpd server, which triggers the backdoor and allows the attacker to gain access to the remote shell with root privileges. Once the attacker has gained access to the remote shell, they can execute arbitrary commands and take full control of the target system.   

## Windows 7
- Demonstration of 2 exploits performed 
- Vulnerabilities discovered

## Binary Exploitation

```ruby
import struct

# ask user for value to overwrite return address
ret_addr = input("Enter return address in hex format (e.g. 0x12345678): ")

# convert hex string to integer
ret_addr_int = int(ret_addr, 16)

# construct payload
payload = b"A" * 40
payload += struct.pack("<Q", ret_addr_int)

print(payload)
```
- The payload is constructed using the struct module to pack data into a binary format.
- The code first prompts the user to enter the memory address of the return address in hexadecimal format, which will be overwritten with a new value to redirect the program flow to an attacker-controlled location.
- The hexadecimal string is then converted to an integer using the **`int()`** function with a base of 16 (hexadecimal). This integer value is used as the argument to **`struct.pack()`**, which packs the value in little-endian byte order (<Q) and returns a bytes object that is concatenated to the payload buffer.
